(globalThis.webpackChunk_openmrs_esm_patient_allergies_app=globalThis.webpackChunk_openmrs_esm_patient_allergies_app||[]).push([[62],{5771:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(272),a=n.n(r),l=n(2609),i=n.n(l)()(a());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-allergies__allergies-detailed-summary__widgetCard___h_2Ps{border:1px solid #e0e0e0}.-esm-patient-allergies__allergies-detailed-summary__allergyCriticality___oKFHF{display:flex;align-items:center;text-transform:uppercase}.-esm-patient-allergies__allergies-detailed-summary__allergySeverityHigh___BXOA1{font-weight:800}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/allergies/allergies-detailed-summary.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,wEACE,wBAAA,CAGF,gFACE,YAAA,CACA,kBAAA,CACA,wBAAA,CAGF,iFACE,eAAA",sourceRoot:""}]),i.locals={widgetCard:"-esm-patient-allergies__allergies-detailed-summary__widgetCard___h_2Ps",allergyCriticality:"-esm-patient-allergies__allergies-detailed-summary__allergyCriticality___oKFHF",allergySeverityHigh:"-esm-patient-allergies__allergies-detailed-summary__allergySeverityHigh___BXOA1"};const o=i},8137:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(272),a=n.n(r),l=n(2609),i=n.n(l)()(a());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}:root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-allergies__allergy-form__productiveHeading01___jVHlb{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__productiveHeading02___AqkSP{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading03___Dz8TI{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading04___O3iLB{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading05___HYHD4{font-size:var(--cds-heading-05-font-size, 2rem);font-weight:var(--cds-heading-05-font-weight, 400);line-height:var(--cds-heading-05-line-height, 1.25);letter-spacing:var(--cds-heading-05-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__productiveHeading06___EpNh_{font-size:var(--cds-heading-06-font-size, 2.625rem);font-weight:var(--cds-heading-06-font-weight, 300);line-height:var(--cds-heading-06-line-height, 1.199);letter-spacing:var(--cds-heading-06-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__bodyShort01___b4MZO{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__bodyShort02___GvHHe{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__bodyLong01___g6fq0{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-allergies__allergy-form__bodyLong02___Rzjzc{font-size:var(--cds-body-02-font-size, 1rem);font-weight:var(--cds-body-02-font-weight, 400);line-height:var(--cds-body-02-line-height, 1.5);letter-spacing:var(--cds-body-02-letter-spacing, 0)}.-esm-patient-allergies__allergy-form__label01___KyOYB{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-allergies__allergy-form__header___QZLSQ{border-bottom:.0625rem solid #e0e0e0;margin:0}.-esm-patient-allergies__allergy-form__content___BiJ1K{display:grid;grid-template-columns:50% 10% 1fr;margin:.5rem 1rem}.-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG fieldset{display:grid;grid-template-columns:1fr 1fr;width:100%}.-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG .cds--radio-button__label{justify-content:flex-start}.-esm-patient-allergies__allergy-form__radio___cCJp1{margin:1rem 0rem}.-esm-patient-allergies__allergy-form__radio___cCJp1 label{justify-content:flex-start}.-esm-patient-allergies__allergy-form__checkbox___A9usx:not(:first-child){margin:.3rem 0rem}.-esm-patient-allergies__allergy-form__input___RQrII{margin:0rem 1rem 1rem}.-esm-patient-allergies__allergy-form__checkboxContainer___EHQjt{display:grid;grid-template-columns:1fr 1fr}.-esm-patient-allergies__allergy-form__button___WnjB1{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-allergies__allergy-form__desktopButtons___Xmt1r{margin-top:2rem}.-esm-patient-allergies__allergy-form__tabletButtons___rIW7a{margin-top:2rem;padding:1.5rem 1rem;background-color:#fff}.-esm-patient-allergies__allergy-form__actionButtons___j4Ggm{position:sticky;bottom:0}.-esm-patient-allergies__allergy-form__formContent___Z4i9n{margin:1rem}.-esm-patient-allergies__allergy-form__form___ri4Rk{display:flex;flex-direction:column;justify-content:space-between}.omrs-breakpoint-gt-tablet .-esm-patient-allergies__allergy-form__form___ri4Rk{height:calc(100vh - 6rem)}.omrs-breakpoint-lt-desktop .-esm-patient-allergies__allergy-form__form___ri4Rk{height:calc(100vh - 9rem)}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/root.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/allergies/allergies-form/allergy-form.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CAHF,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,mEC81BI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CD11BJ,mEC01BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CDt1BJ,mECs1BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CDl1BJ,mECk1BI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CD90BJ,mEC80BI,+CAAA,CAAA,kDAAA,CAAA,mDAAA,CAAA,sDAAA,CD10BJ,mEC00BI,mDAAA,CAAA,kDAAA,CAAA,oDAAA,CAAA,sDAAA,CDt0BJ,2DCs0BI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDl0BJ,2DCk0BI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CD9zBJ,0DC8zBI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CD1zBJ,0DC0zBI,4CAAA,CAAA,+CAAA,CAAA,+CAAA,CAAA,mDAAA,CDtzBJ,uDCszBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CC71BJ,sDACE,oCAAA,CACA,QAAA,CAGF,uDACE,YAAA,CACA,iCAAA,CACA,iBAAA,CAGF,yEACE,YAAA,CACA,6BAAA,CACA,UAAA,CAGF,0FACE,0BAAA,CAGF,qDACE,gBAAA,CAEA,2DACE,0BAAA,CAKF,0EACE,iBAAA,CAIJ,qDACE,qBAAA,CAGF,iEACE,YAAA,CACA,6BAAA,CAGF,sDACE,WAAA,CACA,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,8DACE,eAAA,CAGF,6DACE,eAAA,CACA,mBAAA,CACA,qBH/DM,CGkER,6DACE,eAAA,CACA,QAAA,CAGF,2DACE,WAAA,CAGF,oDACE,YAAA,CACA,qBAAA,CACA,6BAAA,CAKA,+EACE,yBAAA,CAMF,gFACE,yBAAA",sourceRoot:""}]),i.locals={productiveHeading01:"-esm-patient-allergies__allergy-form__productiveHeading01___jVHlb",productiveHeading02:"-esm-patient-allergies__allergy-form__productiveHeading02___AqkSP",productiveHeading03:"-esm-patient-allergies__allergy-form__productiveHeading03___Dz8TI",productiveHeading04:"-esm-patient-allergies__allergy-form__productiveHeading04___O3iLB",productiveHeading05:"-esm-patient-allergies__allergy-form__productiveHeading05___HYHD4",productiveHeading06:"-esm-patient-allergies__allergy-form__productiveHeading06___EpNh_",bodyShort01:"-esm-patient-allergies__allergy-form__bodyShort01___b4MZO",bodyShort02:"-esm-patient-allergies__allergy-form__bodyShort02___GvHHe",bodyLong01:"-esm-patient-allergies__allergy-form__bodyLong01___g6fq0",bodyLong02:"-esm-patient-allergies__allergy-form__bodyLong02___Rzjzc",label01:"-esm-patient-allergies__allergy-form__label01___KyOYB",header:"-esm-patient-allergies__allergy-form__header___QZLSQ",content:"-esm-patient-allergies__allergy-form__content___BiJ1K",wrapperContainer:"-esm-patient-allergies__allergy-form__wrapperContainer___sEcVG",radio:"-esm-patient-allergies__allergy-form__radio___cCJp1",checkbox:"-esm-patient-allergies__allergy-form__checkbox___A9usx",input:"-esm-patient-allergies__allergy-form__input___RQrII",checkboxContainer:"-esm-patient-allergies__allergy-form__checkboxContainer___EHQjt",button:"-esm-patient-allergies__allergy-form__button___WnjB1",desktopButtons:"-esm-patient-allergies__allergy-form__desktopButtons___Xmt1r",tabletButtons:"-esm-patient-allergies__allergy-form__tabletButtons___rIW7a",actionButtons:"-esm-patient-allergies__allergy-form__actionButtons___j4Ggm",formContent:"-esm-patient-allergies__allergy-form__formContent___Z4i9n",form:"-esm-patient-allergies__allergy-form__form___ri4Rk"};const o=i},5807:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(272),a=n.n(r),l=n(2609),i=n.n(l)()(a());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-allergies__allergies-tile__label___dMfkW{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px);color:#525252}.-esm-patient-allergies__allergies-tile__content____n5Gu{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px);color:#525252;margin-top:5px}.-esm-patient-allergies__allergies-tile__value___qWVfJ{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/allergies/allergies-tile.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCpDF,uDC+1BI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CD71BF,aAAA,CAGF,yDC01BI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CDx1BF,aDLQ,CCMR,cAAA,CAGF,uDCo1BI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA",sourceRoot:""}]),i.locals={label:"-esm-patient-allergies__allergies-tile__label___dMfkW",content:"-esm-patient-allergies__allergies-tile__content____n5Gu",value:"-esm-patient-allergies__allergies-tile__value___qWVfJ"};const o=i},8179:(e,t,n)=>{"use strict";n.r(t),n.d(t,{allergiesDashboardLink:()=>ie,allergiesDetailedSummary:()=>le,allergiesForm:()=>oe,allergyTile:()=>se,importTranslation:()=>te,startupApp:()=>ne});var r=n(2870),a=n(2821),l={concepts:{drugAllergenUuid:{_type:r.Type.ConceptUuid,_default:"162552AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},environmentalAllergenUuid:{_type:r.Type.ConceptUuid,_default:"162554AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},foodAllergenUuid:{_type:r.Type.ConceptUuid,_default:"162553AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},mildReactionUuid:{_type:r.Type.ConceptUuid,_default:"1498AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},moderateReactionUuid:{_type:r.Type.ConceptUuid,_default:"1499AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},severeReactionUuid:{_type:r.Type.ConceptUuid,_default:"1500AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},allergyReactionUuid:{_type:r.Type.ConceptUuid,_default:"162555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},otherConceptUuid:{_type:r.Type.ConceptUuid,_default:"5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"}}},i=n(7900),o=n.n(i),s=n(2779),A=n.n(s),c=n(4924),d=n(4398),g=n(8871),m=n(3255);function u(e){var t,n="".concat(r.fhirBaseUrl,"/AllergyIntolerance?patient=").concat(e),a=(0,m.ZP)(e?n:null,r.openmrsFetch),l=a.data,i=a.error,o=a.isLoading,s=a.isValidating,A=a.mutate,c=(null==l||null===(t=l.data)||void 0===t?void 0:t.total)>0?null==l?void 0:l.data.entry.map((function(e){var t;return null!==(t=e.resource)&&void 0!==t?t:[]})).map(_).sort((function(e,t){return t.lastUpdated>e.lastUpdated?1:-1})):null;return{allergies:l?c:null,isError:i,isLoading:o,isValidating:s,mutate:A}}function _(e){var t,n,r,a,l,i,o,s,A,c,d,g,m,u,_,p=null==e||null===(n=e.reaction[0])||void 0===n||null===(t=n.manifestation)||void 0===t?void 0:t.map((function(e){var t;return null===(t=e.coding[0])||void 0===t?void 0:t.display}));return{id:null==e?void 0:e.id,clinicalStatus:null==e||null===(a=e.clinicalStatus)||void 0===a||null===(r=a.coding[0])||void 0===r?void 0:r.display,criticality:null==e?void 0:e.criticality,display:null==e||null===(i=e.code)||void 0===i||null===(l=i.coding[0])||void 0===l?void 0:l.display,recordedDate:null==e?void 0:e.recordedDate,recordedBy:null==e||null===(o=e.recorder)||void 0===o?void 0:o.display,recorderType:null==e||null===(s=e.recorder)||void 0===s?void 0:s.type,note:null==e||null===(c=e.note)||void 0===c||null===(A=c[0])||void 0===A?void 0:A.text,reactionToSubstance:null==e||null===(m=e.reaction[0])||void 0===m||null===(g=m.substance)||void 0===g||null===(d=g.coding[1])||void 0===d?void 0:d.display,reactionManifestations:p,reactionSeverity:null==e||null===(u=e.reaction[0])||void 0===u?void 0:u.severity,lastUpdated:null==e||null===(_=e.meta)||void 0===_?void 0:_.lastUpdated}}var p=n(321),y=n.n(p),f=n(1195),v=n.n(f),C=n(3275),h=n.n(C),b=n(7162),E=n.n(b),D=n(2094),w=n.n(D),B=n(757),k=n.n(B),O=n(5771),S={};S.styleTagTransform=k(),S.setAttributes=E(),S.insert=h().bind(null,"head"),S.domAPI=v(),S.insertStyleElement=w(),y()(O.Z,S);const R=O.Z&&O.Z.locals?O.Z.locals:void 0;var T,j;function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){z(e,t,n[t])}))}return e}!function(e){e.MILD="mild",e.MODERATE="moderate",e.SEVERE="severe"}(T||(T={})),function(e){e.DRUG="DRUG",e.FOOD="FOOD",e.ENVIRONMENT="ENVIRONMENT",e.OTHER="OTHER"}(j||(j={}));var H=n(195),F=n(8883),I=n(3955),U=n(9198),N=n.n(U),P=n(8137),L={};L.styleTagTransform=k(),L.setAttributes=E(),L.insert=h().bind(null,"head"),L.domAPI=v(),L.insertStyleElement=w(),y()(P.Z,L);const M=P.Z&&P.Z.locals?P.Z.locals:void 0;function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function W(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}var Z=H.z.object({allergen:H.z.object({uuid:H.z.string(),display:H.z.string(),type:H.z.string()}).required(),nonCodedAllergen:H.z.string().optional(),allergicReactions:H.z.array(H.z.string().optional()),nonCodedAllergicReaction:H.z.string().optional(),severityOfWorstReaction:H.z.string(),comment:H.z.string().optional()});function J(e){var t=e.children;return e.isTablet?o().createElement(d.mh4,null,t," "):o().createElement(o().Fragment,null,t)}function Q(e){var t=e.allergicReactions,n=e.methods,r=n.control,a=n.setValue,l=(0,i.useCallback)((function(e,t,n,r){e(n),a("allergicReactions.".concat(r),t?n:"",{shouldValidate:!0})}),[a]),s=t.map((function(e,t){return o().createElement(I.Qr,{key:e.uuid,name:"allergicReactions.".concat(t),control:r,defaultValue:"",render:function(n){var r=n.field,a=r.onBlur,i=r.onChange,s=r.value;return o().createElement(d.XZJ,{className:M.checkbox,labelText:e.display,id:e.uuid,onChange:function(e,n){var r=n.checked,a=n.id;l(i,r,a,t)},checked:Boolean(s),onBlur:a})}})}));return o().createElement(o().Fragment,null,s)}var q=n(5807),Y={};Y.styleTagTransform=k(),Y.setAttributes=E(),Y.insert=h().bind(null,"head"),Y.domAPI=v(),Y.insertStyleElement=w(),y()(q.Z,Y);const K=q.Z&&q.Z.locals?q.Z.locals:void 0;function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $="@openmrs/esm-patient-allergies-app",ee={featureName:"patient-allergies",moduleName:$},te=n(3979);function ne(){(0,r.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:".+/ws/rest/v1/concept.+"}),(0,r.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:".+/ws/rest/v1/patient/.+/allergy.+"}),(0,r.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:".+".concat(r.fhirBaseUrl,"/AllergyIntolerance.+")}),(0,r.defineConfigSchema)($,l)}var re,ae,le=(0,r.getSyncLifecycle)((function(e){var t=e.patient,n=(0,c.useTranslation)().t,l=n("allergyIntolerances","allergy intolerances"),i=n("allergies","Allergies"),s=u(t.id),m=s.allergies,_=s.isError,p=s.isLoading,y=s.isValidating,f=(0,r.useLayoutType)(),v="tablet"===f,C="small-desktop"===f||"large-desktop"===f,h=o().useCallback((function(){return(0,a.launchPatientWorkspace)("patient-allergy-form-workspace")}),[]),b=[{key:"display",header:n("allergen","Allergen")},{key:"reactionSeverity",header:n("severityandReaction","Severity")},{key:"reaction",header:n("reaction","Reaction")},{key:"note",header:n("onsetDateAndComments","Onset date and comments")}],E=o().useMemo((function(){return null==m?void 0:m.map((function(e){var t,n;return function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}(x({},e),{reactionSeverity:{content:o().createElement("span",{className:R.allergyCriticality},e.reactionSeverity===T.SEVERE&&o().createElement("svg",{className:"omrs-icon omrs-margin-right-4",fill:"rgba(181, 7, 6, 1)",style:{height:"1.25rem"}},o().createElement("use",{xlinkHref:"#omrs-icon-important-notification"})),o().createElement("span",{className:A()(z({},R.allergySeverityHigh,e.reactionSeverity===T.SEVERE))},e.reactionSeverity))},lastUpdated:e.lastUpdated?(0,r.formatDate)((0,r.parseDate)(e.lastUpdated),{time:!1}):"--",reaction:null===(t=e.reactionManifestations)||void 0===t?void 0:t.join(", "),note:null!==(n=null==e?void 0:e.note)&&void 0!==n?n:"--"})}))}),[m]);return p?o().createElement(d.gqd,{role:"progressbar",compact:C,zebra:!0}):_?o().createElement(a.ErrorState,{error:_,headerTitle:i}):(null==m?void 0:m.length)?o().createElement("div",{className:R.widgetCard},o().createElement(a.CardHeader,{title:i},o().createElement("span",null,y?o().createElement(d.lSo,null):null),o().createElement(d.zxk,{kind:"ghost",renderIcon:function(e){return o().createElement(g.mm,x({size:16},e))},iconDescription:"Add allergies",onClick:h},n("add","Add"))),o().createElement(d.wQF,{rows:E,headers:b,isSortable:!0,useZebraStyles:!0,size:v?"lg":"sm"},(function(e){var t=e.rows,n=e.headers,r=e.getHeaderProps,a=e.getTableProps;return o().createElement(d.xJi,null,o().createElement(d.iA_,x({"aria-label":"allergies summary"},a()),o().createElement(d.ssF,null,o().createElement(d.SCH,null,n.map((function(e){var t,n;return o().createElement(d.xDH,x({className:A()(R.productiveHeading01,R.text02)},r({header:e,isSortable:e.isSortable})),null!==(n=null===(t=e.header)||void 0===t?void 0:t.content)&&void 0!==n?n:e.header)})))),o().createElement(d.RMI,null,t.map((function(e){return o().createElement(d.SCH,{key:e.id},e.cells.map((function(e){var t,n;return o().createElement(d.pj1,{key:e.id},null!==(n=null===(t=e.value)||void 0===t?void 0:t.content)&&void 0!==n?n:e.value)})))})))))}))):o().createElement(a.EmptyState,{displayText:l,headerTitle:i,launchForm:h})}),ee),ie=(0,r.getSyncLifecycle)((0,a.createDashboardLink)((re=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){X(e,t,n[t])}))}return e}({},{slot:"patient-chart-allergies-dashboard-slot",columns:1,path:"Allergies",title:"Allergies"}),ae=null!=(ae={moduleName:$})?ae:{},Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(ae)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(ae)).forEach((function(e){Object.defineProperty(re,e,Object.getOwnPropertyDescriptor(ae,e))})),re)),ee),oe=(0,r.getSyncLifecycle)((function(e){var t,n,a,l,s,g=e.closeWorkspace,m=e.patientUuid,_=(0,c.useTranslation)().t,p=(0,r.useConfig)().concepts,y="tablet"===(0,r.useLayoutType)(),f=[_("mild","Mild"),_("moderate","Moderate"),_("severe","Severe")],v=(0,i.useMemo)((function(){return{patientUuid:m}}),[m]),C=(0,i.useMemo)((function(){return p}),[p]),h=C.mildReactionUuid,b=C.severeReactionUuid,E=C.moderateReactionUuid,D=C.otherConceptUuid,w=(t=(0,r.useConfig)().concepts.allergyReactionUuid,a=(n=N()("/ws/rest/v1/concept/".concat(t,"?v=full"),r.openmrsFetch)).data,{isLoading:n.isLoading,allergicReactions:null==a?void 0:a.data.setMembers.map((function(e){return{uuid:e.uuid,display:e.display}}))}),B=w.allergicReactions,k=w.isLoading,O=function(){var e=(0,r.useConfig)().concepts,t=e.drugAllergenUuid,n=e.environmentalAllergenUuid,a=e.foodAllergenUuid,l=e.otherConceptUuid,o=N()("/ws/rest/v1/concept/".concat(t,"?v=full"),r.openmrsFetch).data,s=N()("/ws/rest/v1/concept/".concat(n,"?v=full"),r.openmrsFetch).data,A=N()("/ws/rest/v1/concept/".concat(a,"?v=full"),r.openmrsFetch).data;return(0,i.useMemo)((function(){var e=[],t=function(t,n){var r,a;null==t||null===(a=t.data)||void 0===a||null===(r=a.setMembers)||void 0===r||r.forEach((function(t){e.push({uuid:t.uuid,display:t.display,type:n})}))};return t(o,j.DRUG),t(s,j.ENVIRONMENT),t(A,j.FOOD),e.forEach((function(t,n){t.uuid===l&&e.splice(n,1)})),e.sort((function(e,t){return e.display.localeCompare(t.display)})),{allergens:e,isLoading:!o||!s||!A}}),[o,s,A])}().allergens,S=(l=(0,i.useState)(!0),s=2,function(e){if(Array.isArray(e))return e}(l)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw a}}return l}}(l,s)||V(l,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),R=S[0],T=S[1],z=u(m).mutate,x=(0,I.cI)({mode:"all",resolver:(0,F.F)(Z),defaultValues:{allergen:null,nonCodedAllergen:"",allergicReactions:[],nonCodedAllergicReaction:"",severityOfWorstReaction:null,comment:""}}),H=x.control,U=x.handleSubmit,P=x.watch,L=(x.getValues,x.setValue),G=P("allergen"),q=P("allergicReactions"),Y=P("severityOfWorstReaction"),K=P("nonCodedAllergen"),X=P("nonCodedAllergicReaction");(0,i.useEffect)((function(){var e=q.some((function(e){return""!==e}));T(!(G&&e&&Y))}),[q,P,G,Y,D,K]);var $=(0,i.useCallback)((function(e){var t=e.allergen,n=e.comment,a=e.nonCodedAllergen,l=e.nonCodedAllergicReaction,i=e.allergicReactions,o=e.severityOfWorstReaction,s=i.filter((function(e){return""!==e})),A={allergen:t.uuid==D?{allergenType:t.type,codedAllergen:{uuid:t.uuid},nonCodedAllergen:a}:{allergenType:t.type,codedAllergen:{uuid:t.uuid}},severity:{uuid:o},comment:n,reactions:null==s?void 0:s.map((function(e){return e===D?{reaction:{uuid:e},reactionNonCoded:l}:{reaction:{uuid:e}}}))},c=new AbortController;(function(e,t,n){return(0,r.openmrsFetch)("/ws/rest/v1/patient/".concat(t,"/allergy"),{headers:{"Content-Type":"application/json"},method:"POST",body:e,signal:n.signal})})(A,m,c).then((function(e){201===e.status&&(z(),g(),(0,r.showSnackbar)({isLowContrast:!0,kind:"success",title:_("allergySaved","Allergy saved"),subtitle:_("allergyNowVisible","It is now visible on the Allergies page")}))}),(function(e){(0,r.showSnackbar)({title:_("allergySaveError","Error saving allergy"),kind:"error",isLowContrast:!1,subtitle:null==e?void 0:e.message})})).finally((function(){return c.abort()}))}),[D,m,g,_,z]);return o().createElement(d.l09,{onSubmit:U($)},y?o().createElement(d.X2j,{className:M.header},o().createElement(r.ExtensionSlot,{className:M.content,name:"patient-details-header-slot",state:v})):null,o().createElement("div",{className:M.form},o().createElement(d.Kqy,{gap:7,className:M.formContent},(null==G?void 0:G.uuid)===D&&o().createElement(d.K0D,{style:{minWidth:"100%"},kind:"warning",lowContrast:!0,hideCloseButton:!0,title:_("nonCodedAllergenWarningTitle","Warning: Custom Allergen Entry"),subtitle:_("nonCodedAllergenWarningDescription","Adding a custom allergen may impact system-wide allergy notifications. It's recommended to choose from the provided list for accurate alerts. Custom entries may not trigger notifications in all relevant contexts.")}),o().createElement(J,{isTablet:y},o().createElement(d.cwH,{legendText:_("allergen","Allergen"),"data-testid":"allergens-container"},o().createElement(I.Qr,{name:"allergen",control:H,render:function(e){var t=e.field,n=t.value,r=t.onChange;return o().createElement(d.CtY,{id:"allergen",items:W(O).concat([{uuid:D,display:_("other","Other"),type:j.OTHER}]),itemToString:function(e){return null==e?void 0:e.display},placeholder:_("selectAllergen","Select the allergen"),selectedItem:n,onChange:function(e){var t=e.selectedItem;return r(t)}})}}))),(null==G?void 0:G.uuid)===D&&o().createElement(J,{isTablet:y},o().createElement(I.Qr,{name:"nonCodedAllergen",control:H,render:function(e){var t=e.field,n=t.onBlur,r=t.onChange,a=t.value;return o().createElement(d.oil,{id:"nonCodedAllergen",labelText:_("otherNonCodedAllergen","Other non-coded allergen"),onChange:r,onBlur:n,value:a,placeholder:_("typeAllergenName","Please type in the name of the allergen")})}})),o().createElement("div",null,o().createElement("div",{className:y?M.checkboxContainer:void 0},k?o().createElement(d.lSo,{description:"".concat(_("loading","Loading")," ...")}):o().createElement(d.cwH,{legendText:_("selectReactions","Select the reactions"),"data-testid":"allergic-reactions-container"},o().createElement(Q,{allergicReactions:B,methods:{setValue:L,control:H}}))),(null==q?void 0:q.includes(D))?o().createElement("div",{className:M.input},o().createElement(J,{isTablet:y},o().createElement(I.Qr,{name:"nonCodedAllergicReaction",control:H,render:function(e){var t=e.field,n=t.onBlur,r=t.onChange,a=t.value;return o().createElement(d.oil,{id:"nonCodedAllergicReaction",labelText:_("otherNonCodedAllergicReaction","Other non-coded allergic reaction"),onChange:r,onBlur:n,value:a,placeholder:_("typeAllergicReactionName","Please type in the name of the allergic reaction")})}}))):null),o().createElement("div",null,o().createElement(d.cwH,{legendText:_("severityOfWorstReaction","Severity of worst reaction")},o().createElement(I.Qr,{name:"severityOfWorstReaction",control:H,render:function(e){var t=e.field,n=t.onBlur,r=t.onChange,a=t.value;return o().createElement(d.SYO,{name:"severity-of-worst-reaction",onChange:function(e){return r(e.toString())},valueSelected:a,onBlur:n,labelText:_("severityOfWorstReaction","Severity of worst reaction")},f.map((function(e,t){return o().createElement(d.EUY,{id:e.toLowerCase()+"Severity",key:"severity-".concat(t),labelText:e,value:function(){switch(e.toLowerCase()){case"mild":return h;case"moderate":return E;case"severe":return b;default:return""}}()})})))}}))),o().createElement("div",null,o().createElement(J,{isTablet:y},o().createElement(I.Qr,{name:"comment",control:H,render:function(e){var t=e.field,n=t.onBlur,r=t.onChange,a=t.value;return o().createElement(d.Kx8,{id:"comments",invalidText:_("invalidComment","Invalid comment, try again"),labelText:_("dateOfOnsetAndComments","Date of onset and comments"),onChange:r,placeholder:_("typeAdditionalComments","Type any additional comments here"),onBlur:n,value:a,rows:4})}})))),o().createElement(d.uVA,{className:A()(y?M.tabletButtons:M.desktopButtons,M.actionButtons)},o().createElement(d.zxk,{className:M.button,onClick:g,kind:"secondary"},_("discard","Discard")),o().createElement(d.zxk,{className:M.button,disabled:R||(null==G?void 0:G.uuid)===D&&!K||(null==q?void 0:q.includes(D))&&!X,type:"submit",kind:"primary"},_("saveAndClose","Save and close")))))}),ee),se=(0,r.getSyncLifecycle)((function(e){var t=e.patientUuid,n=(0,c.useTranslation)().t,r=u(t),a=r.allergies;return r.isLoading?o().createElement(d.lSo,{role:"progressbar",description:"".concat(n("loading","Loading")," ...")}):(null==a?void 0:a.length)?o().createElement("div",null,o().createElement("p",{className:K.label},n("allergies","Allergies")),o().createElement("p",{className:K.content},o().createElement("span",{className:K.value},null==a?void 0:a.map((function(e){return null==e?void 0:e.display})).join(", ")))):o().createElement("div",null,o().createElement("p",{className:K.label},n("allergies","Allergies")),o().createElement("p",{className:K.content},"--"))}),ee)},3979:(e,t,n)=>{var r={"./am.json":[8788,788],"./ar.json":[4460,460],"./en.json":[3574,574],"./es.json":[8319,319],"./fr.json":[2757,757],"./he.json":[5833,833],"./km.json":[7807,807],"./zh.json":[8271,271],"./zh_CN.json":[1644,644]};function a(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((()=>n(a)))}a.keys=()=>Object.keys(r),a.id=3979,e.exports=a}}]);